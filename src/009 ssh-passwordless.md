# Настройка ssh аутентификации при помощи публичного ключа
Этот вариант аутентификации для ssh является еще более безопасным, чем просто использование ssh с именем пользователя и паролем.
## Предварительные условия
1. Настроена и запущена виртуальная машина с Ubuntu.
2. Для виртуальной машины настроено Bridged сетевое соединение.
3. На виртуальной машине установлен и работает ssh сервер.
4. Вы можете войти по ssh с локальной Windows (на самом деле уже неважно) машины на виртуальную машину с Ubuntu.

## Генерируем ключи в git bash
1. Запускаем git bash
2. Проверяем, нет ли у нас случайно уже сгенерированных ключей (например, вы купили краденный ноут и не переустанавливали систему):

```ls -l ~/.ssh```
Такой вывод результатов команды говорит нам о том, что ключей у нас нет:

![NoNothing](./img/009%20RsaNoKeys.png)

Такой означает, что ключи все же есть (вам лучше знать, откуда они):
![NotNoNothing](./img/009%20RsaThereAreSomeKeys.png)

3. Всё же генерируем ключи

> Сразу договоримся: *"your_email@example.com"* — это ваш настоящий адрес электронной почты, т.е. эту строку нужно заменить при выполнении команды! Я предупредил.

```ssh-keygen -t rsa -b 4096 -C "your_email@example.com" ```

Генератор спросит нас, куда бы нам записать эти ключи. Используем папку, которую он хочет по умолчанию:

![Accept path](./img/009%20RsaAcceptDir.png)

4. Генератор спросит вас, какой пароль использовать для шифрования секретного ключа. Этот пароль будет необходимо вводить каждый раз, когда вам нужно будет этот ключ использовать. 
> Для тестовых целей можно этот пароль не вводить и просто два раза нажать Enter, потом этот пароль можно будет задать, если вы планируете этот ключ использовать и заботитесь о безопасности. Это важно. :point_up: 

Вот это окно означает, что пара ключей секретный (private) и публичный (public) были успешно для вас сгенерированы.

![Keys are generated](./img/009%20RsaYesYesYes.png)

Ок!

4. добавляем ключи ssh агенту

>Чтобы этими ключами пользоваться при работе, необходимо, чтобы ssh агент на нашей стороне знал о них.

всё в том же окне git bash:

```ssh-add ~/.ssh/id_rsa```

Агент добавит себе этот ключ и будет с ним работать.

#### лирическое отступление

>**~** в этих ваших линуксах означает домашнюю директорию пользователя.
>
>В Windows это будет что-то вроде ```C:\Users\%username%\```, если вам придет в голову искать это. 

Попасть в ту же самую папку ~, на которую ссылается git bash можно вот так:

![picture](./img/009%20RsaWinHome.png)

Да, да, да. Прямо в проводнике вводим ```%HOMEPATH%``` нажимаем Enter и попадаем в ```C:\Users\%username%\```. Профит!

5. Проверяем, жив ли ssh агент

там же, в git bash:

```eval "$(ssh-agent -s)"```

Если все хорошо, то это будет выглядеть так:

![picture](./img/009%20RsaAgentIsAlive.png)







[Оглавление](./000%20toc.md)